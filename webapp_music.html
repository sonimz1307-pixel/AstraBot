<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <title>–ú—É–∑—ã–∫–∞ –±—É–¥—É—â–µ–≥–æ</title>

  <!-- ‚úÖ Telegram WebApp SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    :root{
      --bg:#0b1020;
      --card:rgba(255,255,255,.06);
      --card2:rgba(255,255,255,.09);
      --text:rgba(255,255,255,.92);
      --muted:rgba(255,255,255,.62);
      --muted2:rgba(255,255,255,.45);
      --border:rgba(255,255,255,.12);
      --accent:#3aa8ff;
      --danger:#ff5a6a;
      --ok:#39d98a;
      --radius:18px;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:var(--text);
      background: radial-gradient(1200px 700px at 20% 10%, rgba(58,168,255,.18), transparent 60%),
                  radial-gradient(900px 700px at 80% 30%, rgba(110,231,255,.12), transparent 55%),
                  linear-gradient(180deg, #070a14 0%, #0b1020 50%, #070a14 100%);
      min-height:100vh;
    }
    .wrap{
      padding:18px 14px 28px;
      max-width:520px;
      margin:0 auto;
    }
    .header{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; margin-bottom:12px;
    }
    .brand{display:flex; flex-direction:column; gap:2px;}
    .brand h1{font-size:18px; margin:0; letter-spacing:.2px;}
    .brand .sub{font-size:12px; color:var(--muted);}
    .pill{
      padding:8px 10px;
      border:1px solid var(--border);
      border-radius:999px;
      background:rgba(255,255,255,.04);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }

    .card{
      background:var(--card);
      border:1px solid var(--border);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:14px;
      margin-top:12px;
      backdrop-filter: blur(10px);
    }

    .tabs{
      display:flex; gap:8px;
      background:rgba(255,255,255,.04);
      border:1px solid var(--border);
      border-radius:999px;
      padding:6px;
    }
    .tab{
      flex:1;
      text-align:center;
      padding:10px 10px;
      border-radius:999px;
      cursor:pointer;
      user-select:none;
      font-weight:650;
      color:var(--muted);
      transition:.15s ease;
      font-size:13px;
    }
    .tab.active{
      background:linear-gradient(90deg, rgba(58,168,255,.35), rgba(110,231,255,.22));
      color:var(--text);
      border:1px solid rgba(58,168,255,.30);
    }

    label{
      display:block; font-size:12px; color:var(--muted);
      margin:12px 0 6px;
    }
    input[type="text"], textarea{
      width:100%;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--border);
      background:rgba(0,0,0,.16);
      color:var(--text);
      outline:none;
      transition:.15s ease;
    }
    textarea{min-height:120px; resize:vertical; line-height:1.35}
    input:focus, textarea:focus{
      border-color:rgba(58,168,255,.55);
      box-shadow:0 0 0 3px rgba(58,168,255,.14);
    }
    .hint{margin-top:8px; color:var(--muted2); font-size:12px; line-height:1.35;}

    .toggle{
      display:flex; align-items:center; gap:10px;
      margin-top:10px;
      padding:12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:rgba(255,255,255,.03);
    }
    .toggle input{width:18px; height:18px}
    .toggle .ttext{display:flex; flex-direction:column; gap:2px}
    .toggle .ttext b{font-size:13px}
    .toggle .ttext span{font-size:12px; color:var(--muted)}

    .chips{display:flex; gap:8px; flex-wrap:wrap; margin-top:10px;}
    .chip{
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
      border-radius:999px;
      padding:8px 10px;
      font-size:12px;
      cursor:pointer;
      user-select:none;
      transition:.12s ease;
    }
    .chip:hover{transform:translateY(-1px); border-color:rgba(58,168,255,.45)}
    .chip:active{transform:translateY(0px)}
    .chip.small{padding:6px 9px; font-size:11px; color:var(--muted)}
    .chip.on{
      background:linear-gradient(90deg, rgba(58,168,255,.28), rgba(110,231,255,.18));
      border-color:rgba(58,168,255,.55);
    }

    .actions{display:flex; gap:10px; margin-top:14px;}
    .btn{
      flex:1;
      border:1px solid var(--border);
      background:rgba(255,255,255,.05);
      color:var(--text);
      padding:12px 12px;
      border-radius:14px;
      cursor:pointer;
      font-weight:700;
      letter-spacing:.2px;
    }
    .btn.primary{
      background:linear-gradient(90deg, rgba(58,168,255,.42), rgba(110,231,255,.22));
      border-color:rgba(58,168,255,.45);
    }
    .btn:active{transform:translateY(1px)}
    .footer-note{margin-top:10px; font-size:12px; color:var(--muted2); line-height:1.35}

    details{
      margin-top:12px;
      border:1px solid var(--border);
      border-radius:14px;
      background:rgba(255,255,255,.03);
      padding:10px 12px;
    }
    details summary{cursor:pointer; font-weight:700; color:var(--muted); outline:none;}
    details .dcontent{margin-top:10px; color:var(--muted); font-size:12px; line-height:1.45;}
    code.inline{
      background:rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      padding:2px 6px;
      border-radius:8px;
      font-size:11px;
      color:rgba(255,255,255,.85);
    }
    .warn{
      margin-top:10px;
      border:1px solid rgba(255,90,106,.35);
      background:rgba(255,90,106,.06);
      padding:10px 12px;
      border-radius:14px;
      font-size:12px;
      color:rgba(255,255,255,.78);
      line-height:1.4;
    }
    .ok{
      margin-top:10px;
      border:1px solid rgba(57,217,138,.35);
      background:rgba(57,217,138,.06);
      padding:10px 12px;
      border-radius:14px;
      font-size:12px;
      color:rgba(255,255,255,.78);
      line-height:1.4;
    }

    /* -----------------------------
       Guide modal (simple & native)
       ----------------------------- */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:flex-end;
      justify-content:center;
      padding:14px 14px calc(14px + env(safe-area-inset-bottom));
      z-index:9999;
    }
    .modal{
      width:min(520px, 100%);
      max-height:85vh;
      background:rgba(12,16,32,.92);
      border:1px solid rgba(255,255,255,.14);
      border-radius:18px;
      box-shadow:0 14px 40px rgba(0,0,0,.55);
      overflow:hidden;
      backdrop-filter: blur(12px);
    }
    .modal-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px 12px;
      border-bottom:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
    }
    .modal-header b{font-size:14px}
    .icon-btn{
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.06);
      color:rgba(255,255,255,.88);
      border-radius:12px;
      padding:8px 10px;
      cursor:pointer;
      font-weight:800;
      line-height:1;
    }
    .modal-body{
      padding:12px 12px 14px;
      overflow:auto;
      max-height:calc(85vh - 52px);
      color:rgba(255,255,255,.86);
      font-size:13px;
      line-height:1.45;
    }
    .modal-body h3{
      margin:10px 0 6px;
      font-size:13px;
      letter-spacing:.2px;
    }
    .modal-body .muted{
      color:rgba(255,255,255,.65);
      font-size:12px;
    }
    .modal-body .box{
      margin-top:10px;
      padding:10px 10px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
    }
    .modal-body ul{margin:8px 0 0 18px; padding:0;}
    .modal-body li{margin:6px 0;}
    .link-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(58,168,255,.35);
      background:linear-gradient(90deg, rgba(58,168,255,.22), rgba(110,231,255,.10));
      color:rgba(255,255,255,.92);
      cursor:pointer;
      font-weight:750;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="brand">
        <h1>üéµ –ú—É–∑—ã–∫–∞ –±—É–¥—É—â–µ–≥–æ</h1>
        <div class="sub">–°–æ–±–µ—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –≤–µ—Ä–Ω–∏—Å—å –≤ –±–æ—Ç</div>
      </div>
      <div class="pill" id="tgBadge">Telegram WebApp</div>
    </div>

    <div class="card">

      <div class="tabs" role="tablist" aria-label="AI" style="margin-bottom:10px">
        <div class="tab" id="aiSuno" role="tab" aria-selected="false">Suno</div>
        <div class="tab active" id="aiUdio" role="tab" aria-selected="true">Udio</div>
      </div>
      <div class="tabs" role="tablist" aria-label="–†–µ–∂–∏–º">
        <div class="tab active" id="tabIdea" role="tab" aria-selected="true">‚ú® –ò–¥–µ—è</div>
        <div class="tab" id="tabLyrics" role="tab" aria-selected="false">üìù –¢–µ–∫—Å—Ç</div>
      </div>

      <div class="ok" id="udioNote" style="display:none">Udio –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ <b>–û–ø–∏—Å–∞–Ω–∏–µ –∏–¥–µ–∏</b>. –¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ –∏ —Ç–µ–≥–∏ –≤ —ç—Ç–æ–º —Ä–µ–∂–∏–º–µ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è.</div>

      <div id="wrapTitle">
      <label for="title">–ù–∞–∑–≤–∞–Ω–∏–µ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
      <input id="title" type="text" placeholder="–ù–∞–ø—Ä.: –ú—É–∑—ã–∫–∞ –±—É–¥—É—â–µ–≥–æ"/>
      </div>

      <div id="wrapTags">
      <label for="tags">–¢–µ–≥–∏ (—Å—Ç–∏–ª—å/–∂–∞–Ω—Ä)</label>
      <input id="tags" type="text" placeholder="–ù–∞–ø—Ä.: russian pop, upbeat, modern, catchy hook"/>
      <div class="hint">
        –¢–µ–≥–∏ —Å–∏–ª—å–Ω–µ–µ –≤—Å–µ–≥–æ –≤–ª–∏—è—é—Ç –Ω–∞ —Å—Ç–∏–ª—å: –∂–∞–Ω—Ä, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, –≤–æ–∫–∞–ª, –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã.
        <br/><b>–õ—É—á—à–µ –ø–∏—Å–∞—Ç—å —Ç–µ–≥–∏ –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏</b> (–Ω–∞–ø—Ä–∏–º–µ—Ä: <code class="inline">female vocal</code>, <code class="inline">male vocal</code>, <code class="inline">calm</code>).
      </div>

      <div class="chips" id="moodChips">
        <div class="chip small" data-add="energetic">‚ö° —ç–Ω–µ—Ä–≥–∏—á–Ω–æ–µ</div>
      </div>
        <div class="chip small" data-add="calm">üòå —Å–ø–æ–∫–æ–π–Ω–æ–µ</div>
        <div class="chip small" data-add="sad">üíî –≥—Ä—É—Å—Ç–Ω–æ–µ</div>
        <div class="chip small" data-add="dark">üåë —Ç—ë–º–Ω–æ–µ</div>
        <div class="chip small" data-add="club">ü™© club</div>
        <div class="chip small" data-add="viral hook">üéØ viral hook</div>
        <div class="chip small" data-add="female vocal">‚ôÄÔ∏è female vocal</div>
        <div class="chip small" data-add="male vocal">‚ôÇÔ∏è male vocal</div>
        <div class="chip small" data-add="duet">üë´ duet</div>
      </div>

      <div class="toggle">
        <input id="instr" type="checkbox"/>
        <div class="ttext">
          <b>–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª</b>
          <span>–ë–µ–∑ –≤–æ–∫–∞–ª–∞ (—Ç–æ–ª—å–∫–æ –º—É–∑—ã–∫–∞)</span>
        </div>
      </div>

      <div id="ideaBlock">
        <label for="desc">–û–ø–∏—Å–∞–Ω–∏–µ –∏–¥–µ–∏ (–∫–æ—Ä–æ—Ç–∫–æ)</label>
        <textarea id="desc" placeholder="–ñ–∞–Ω—Ä, –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ, —Ç–µ–º–∞, —è–∑—ã–∫, —Ä–µ—Ñ–µ—Ä–µ–Ω—Å—ã. –ü—Ä–∏–º–µ—Ä: Calm russian pop song about love, female vocal, catchy chorus"></textarea>
        <div class="hint">–≠—Ç–æ—Ç —Ä–µ–∂–∏–º –ø—Ä–æ—â–µ: —Ç—ã –¥–∞—ë—à—å –∏–¥–µ—é ‚Äî –ò–ò —Å–∞–º –ø—Ä–∏–¥—É–º–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏ —Å–ª–æ–≤–∞.</div>
      </div>

      <div id="lyricsBlock" style="display:none">
        <label for="lyrics">–¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ (—Å—Ç—Ä—É–∫—Ç—É—Ä–∞)</label>
        <textarea id="lyrics" placeholder="[Verse]
...
[Chorus]
..."></textarea>
        <div class="hint">
          –≠—Ç–æ—Ç —Ä–µ–∂–∏–º –¥–∞—ë—Ç –±–æ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—è: —Ç—ã —Å–∞–º –∑–∞–¥–∞—ë—à—å –∫—É–ø–ª–µ—Ç—ã/–ø—Ä–∏–ø–µ–≤—ã.
          <br/><b>–õ—É—á—à–µ –ø–æ–º–µ—Ç–∫–∏ –ø–∏—Å–∞—Ç—å –ø–æ-–∞–Ω–≥–ª–∏–π—Å–∫–∏</b>: <code class="inline">[Verse]</code>, <code class="inline">[Chorus]</code>, <code class="inline">[Bridge]</code>.
        </div>
      </div>

      <div id="wrapGuide">
      <details>
        <summary>–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å ¬´–≤–∞—É¬ª-—Ä–µ–∑—É–ª—å—Ç–∞—Ç (–∫—Ä–∞—Ç–∫–æ)</summary>
        <div class="dcontent">
          <b>1) –°–Ω–∞—á–∞–ª–∞ —Ç–µ–≥–∏.</b> 4‚Äì8 —Ç–µ–≥–æ–≤ ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ. –ü—Ä–∏–º–µ—Ä:
          <code class="inline">russian pop, modern, female vocal, calm, catchy hook</code><br/>
          <b>2) –ü–æ—Ç–æ–º 1‚Äì2 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –∏–¥–µ–∏.</b> –¢–µ–º–∞ + –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ + –≥–¥–µ –∑–≤—É—á–∏—Ç (club / tiktok / cinematic).<br/>
          <b>3) –ï—Å–ª–∏ –ø–∏—à–µ—à—å —Ç–µ–∫—Å—Ç:</b> –¥–µ–ª–∞–π –∫–æ—Ä–æ—Ç–∫–∏–µ —Å—Ç—Ä–æ–∫–∏, –ø–æ–≤—Ç–æ—Ä—è–π –ø—Ä–∏–ø–µ–≤ 2‚Äì3 —Ä–∞–∑–∞, –∏—Å–ø–æ–ª—å–∑—É–π <code class="inline">[Chorus]</code>.
          <div>
            <button class="link-btn" id="btnOpenGuide" type="button">üìñ –û—Ç–∫—Ä—ã—Ç—å –ø–æ–ª–Ω—ã–π –≥–∞–π–¥</button>
          </div>
        </div>
      </details>
      </div>

      <div class="actions">
        <button class="btn" id="btnClear" type="button">–û—á–∏—Å—Ç–∏—Ç—å</button>
        <button class="btn primary" id="btnSave" type="button">‚úÖ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è</button>
      </div>

      <div class="footer-note">
        –ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –±–æ—Ç –ª–∏–±–æ –ø–æ–ø—Ä–æ—Å–∏—Ç —Ç–µ–∫—Å—Ç/–∏–¥–µ—é (–µ—Å–ª–∏ –ø—É—Å—Ç–æ), –ª–∏–±–æ –º–æ–∂–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Å—Ä–∞–∑—É ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–æ—Ç–∞.
      </div>

      <div class="warn" id="warnTg" style="display:none">
        –ù–µ –≤–∏–∂—É Telegram WebApp API. –ï—Å–ª–∏ —Ç—ã –æ—Ç–∫—Ä—ã–ª —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤ –æ–±—ã—á–Ω–æ–º –±—Ä–∞—É–∑–µ—Ä–µ ‚Äî –∫–Ω–æ–ø–∫–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ —Å—Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ –±–æ—Ç–∞ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–∞.
      </div>

      <div class="ok" id="okCopied" style="display:none">–ì–æ—Ç–æ–≤–æ ‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç.</div>
    </div>
  </div>

  <!-- Full guide modal -->
  <div class="modal-backdrop" id="guideBackdrop" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true" aria-label="–ì–∞–π–¥ Suno">
      <div class="modal-header">
        <b>üéµ –ü–æ–ª–Ω—ã–π –≥–∞–π–¥: –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –∫—Ä—É—Ç–æ–π —Ç—Ä–µ–∫</b>
        <button class="icon-btn" id="btnCloseGuide" type="button">‚úï</button>
      </div>
      <div class="modal-body">
        <div class="muted">
          –ì–ª–∞–≤–Ω–æ–µ –ø—Ä–∞–≤–∏–ª–æ: <b>–∫–æ–º–∞–Ω–¥—ã –∏ –ø–æ–º–µ—Ç–∫–∏ –ª—É—á—à–µ –ø–∏—Å–∞—Ç—å –ø–æ‚Äë–∞–Ω–≥–ª–∏–π—Å–∫–∏</b> ‚Äî Suno –ø–æ–Ω–∏–º–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–µ–µ.
          –¢–µ–∫—Å—Ç –ø–µ—Å–Ω–∏ –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –Ω–∞ —Ä—É—Å—Å–∫–æ–º.
        </div>

        <div class="box">
          <h3>1) –†–µ–∂–∏–º—ã</h3>
          <ul>
            <li><b>‚ú® –ò–¥–µ—è</b> ‚Äî —Ç—ã –æ–ø–∏—Å—ã–≤–∞–µ—à—å –ø–µ—Å–Ω—é (–≤–∞–π–±/–∂–∞–Ω—Ä/—Ç–µ–º–∞). –ò–ò —Å–∞–º –ø—Ä–∏–¥—É–º–∞–µ—Ç —Å–ª–æ–≤–∞ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É.</li>
            <li><b>üìù –¢–µ–∫—Å—Ç</b> ‚Äî —Ç—ã –¥–∞—ë—à—å –≥–æ—Ç–æ–≤—ã–µ —Å–ª–æ–≤–∞. –ò–ò –ø–æ–¥–±–µ—Ä—ë—Ç –º—É–∑—ã–∫—É –∏ –≤–æ–∫–∞–ª –ø–æ–¥ —Ç–≤–æ–π —Ç–µ–∫—Å—Ç.</li>
          </ul>
        </div>

        <div class="box">
          <h3>2) –¢–µ–≥–∏ (—Å–∞–º–æ–µ –≤–∞–∂–Ω–æ–µ)</h3>
          <div class="muted">–ü–∏—à–∏ 4‚Äì8 —Ç–µ–≥–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é. –õ—É—á—à–µ –ø–æ‚Äë–∞–Ω–≥–ª–∏–π—Å–∫–∏.</div>
          <ul>
            <li><b>–ñ–∞–Ω—Ä/—Å—Ç–∏–ª—å:</b> <code class="inline">pop</code>, <code class="inline">rap</code>, <code class="inline">house</code>, <code class="inline">lofi</code>, <code class="inline">phonk</code></li>
            <li><b>–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ:</b> <code class="inline">calm</code>, <code class="inline">sad</code>, <code class="inline">dark</code>, <code class="inline">energetic</code></li>
            <li><b>–ì–æ–ª–æ—Å:</b> <code class="inline">female vocal</code>, <code class="inline">male vocal</code>, <code class="inline">duet</code></li>
            <li><b>–•—É–∫:</b> <code class="inline">catchy hook</code>, <code class="inline">viral hook</code></li>
          </ul>
          <div class="muted">–ü—Ä–∏–º–µ—Ä: <code class="inline">russian pop, modern, female vocal, calm, catchy hook</code></div>
        </div>

        <div class="box">
          <h3>3) –ö–∞–∫ –≤—ã–¥–µ–ª–∏—Ç—å –ø—Ä–∏–ø–µ–≤</h3>
          <div class="muted">–°–∞–º—ã–π –Ω–∞–¥—ë–∂–Ω—ã–π —Å–ø–æ—Å–æ–± ‚Äî —Å–µ–∫—Ü–∏–∏ –≤ –∫–≤–∞–¥—Ä–∞—Ç–Ω—ã—Ö —Å–∫–æ–±–∫–∞—Ö:</div>
          <div class="box" style="margin-top:8px">
            <code class="inline">[Verse]</code> ‚Äî –∫—É–ø–ª–µ—Ç<br/>
            <code class="inline">[Chorus]</code> ‚Äî –ø—Ä–∏–ø–µ–≤ (–ø–æ–≤—Ç–æ—Ä–∏ 2‚Äì3 —Ä–∞–∑–∞)<br/>
            <code class="inline">[Bridge]</code> ‚Äî –±—Ä–∏–¥–∂ (–ø–µ—Ä–µ—Ö–æ–¥)
          </div>
          <div class="muted" style="margin-top:8px">
            –ú–æ–∂–Ω–æ –ø–æ‚Äë—Ä—É—Å—Å–∫–∏ (‚Äú–ö—É–ø–ª–µ—Ç/–ü—Ä–∏–ø–µ–≤‚Äù), –Ω–æ —ç—Ç–æ –º–µ–Ω–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ.
          </div>
        </div>

        <div class="box">
          <h3>4) –ú—É–∂—Å–∫–æ–π / –∂–µ–Ω—Å–∫–∏–π –≥–æ–ª–æ—Å / –¥—É—ç—Ç</h3>
          <ul>
            <li><b>–ñ–µ–Ω—Å–∫–∏–π:</b> –¥–æ–±–∞–≤—å <code class="inline">female vocal</code></li>
            <li><b>–ú—É–∂—Å–∫–æ–π:</b> –¥–æ–±–∞–≤—å <code class="inline">male vocal</code></li>
            <li><b>–î—É—ç—Ç:</b> –¥–æ–±–∞–≤—å <code class="inline">duet</code> –∏/–∏–ª–∏ –ø–æ–º–µ—Ç—å —Å–µ–∫—Ü–∏–∏: <code class="inline">[Verse - Male Vocal]</code>, <code class="inline">[Chorus - Duet]</code></li>
          </ul>
        </div>

        <div class="box">
          <h3>5) –ï—Å–ª–∏ ‚Äú–Ω–µ —Ç–æ –ø–æ–ª—É—á–∏–ª–æ—Å—å‚Äù</h3>
          <ul>
            <li>–£–ø—Ä–æ—Å—Ç–∏ —Ç–µ–≥–∏ (—É–±–µ—Ä–∏ –ª–∏—à–Ω–µ–µ), –æ—Å—Ç–∞–≤—å 4‚Äì8.</li>
            <li>–°–¥–µ–ª–∞–π –ø—Ä–∏–ø–µ–≤ –∫–æ—Ä–æ—á–µ –∏ –ø–æ–≤—Ç–æ—Ä–∏ 2‚Äì3 —Ä–∞–∑–∞.</li>
            <li>–î–æ–±–∞–≤—å/—É—Ç–æ—á–Ω–∏ –≥–æ–ª–æ—Å: <code class="inline">female vocal</code> –∏–ª–∏ <code class="inline">male vocal</code>.</li>
            <li>–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –µ—â—ë —Ä–∞–∑ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ.</li>
          </ul>
        </div>

        <button class="link-btn" id="btnCloseGuide2" type="button">‚úÖ –ü–æ–Ω—è—Ç–Ω–æ, –∑–∞–∫—Ä—ã—Ç—å</button>
      </div>
    </div>
  </div>

  <script>
    // -----------------------------
    // Telegram init (—É—Å—Ç–æ–π—á–∏–≤—ã–π)
    // -----------------------------
    const tgBadge = document.getElementById('tgBadge');
    const warnTg = document.getElementById('warnTg');
    const okCopied = document.getElementById('okCopied');

    function getTg(){
      return (window.Telegram && window.Telegram.WebApp) ? window.Telegram.WebApp : null;
    }

    function initTelegram(){
      const t = getTg();
      if (!t) {
        tgBadge.textContent = "Browser Preview";
        warnTg.style.display = "block";
        return null;
      }
      warnTg.style.display = "none";
      tgBadge.textContent = "Telegram WebApp";
      try { t.ready(); } catch(e){}
      try { t.expand(); } catch(e){}
      return t;
    }

    // In some clients object appears not instantly
    let tg = initTelegram();
    if (!tg) setTimeout(() => { tg = initTelegram(); }, 150);
    if (!tg) setTimeout(() => { tg = initTelegram(); }, 350);

    // -----------------------------
    // Tabs
    // -----------------------------
    let mode = "idea";
    let ai = localStorage.getItem("music_ai") || "suno"; // idea | lyrics
    const aiSuno = document.getElementById('aiSuno');
    const aiUdio = document.getElementById('aiUdio');

    function applyAiUI(){
  const isUdio = (ai === "udio");

  // Udio notice
  const udioNote = document.getElementById("udioNote");
  if (udioNote) udioNote.style.display = isUdio ? "block" : "none";

  // Hide Suno-only blocks
  const wrapTitle = document.getElementById("wrapTitle");
  const wrapTags  = document.getElementById("wrapTags");
  const wrapGuide = document.getElementById("wrapGuide");
  if (wrapTitle) wrapTitle.style.display = isUdio ? "none" : "block";
  if (wrapTags)  wrapTags.style.display  = isUdio ? "none" : "block";
  if (wrapGuide) wrapGuide.style.display = isUdio ? "none" : "block";

  // Tabs: in Udio only "idea"
  tabLyrics.style.display = isUdio ? "none" : "block";
  if (isUdio) setMode("idea");
}

function setAI(v){
  ai = v;
  localStorage.setItem("music_ai", v);
  aiSuno.classList.toggle('active', v === "suno");
  aiUdio.classList.toggle('active', v === "udio");
  applyAiUI();
}

aiSuno.onclick = () => setAI("suno");
aiUdio.onclick = () => setAI("udio");
setAI(ai);

    const tabIdea = document.getElementById('tabIdea');
    const tabLyrics = document.getElementById('tabLyrics');
    const ideaBlock = document.getElementById('ideaBlock');
    const lyricsBlock = document.getElementById('lyricsBlock');

    function setMode(m){
      mode = m;
      const isIdea = (m === "idea");
      tabIdea.classList.toggle('active', isIdea);
      tabLyrics.classList.toggle('active', !isIdea);
      tabIdea.setAttribute('aria-selected', isIdea ? 'true' : 'false');
      tabLyrics.setAttribute('aria-selected', !isIdea ? 'true' : 'false');
      ideaBlock.style.display = isIdea ? 'block' : 'none';
      lyricsBlock.style.display = isIdea ? 'none' : 'block';
    }
    tabIdea.addEventListener('click', () => setMode("idea"));
    tabLyrics.addEventListener('click', () => setMode("lyrics"));

    // -----------------------------
    // Chips -> add to tags
    // -----------------------------
    const tagsEl = document.getElementById('tags');
    document.getElementById('moodChips').addEventListener('click', (e) => {
      const chip = e.target.closest('.chip');
      if(!chip) return;
      const add = (chip.dataset.add || "").trim();
      if(!add) return;

      chip.classList.toggle('on');
      const parts = tagsEl.value.split(',').map(s=>s.trim()).filter(Boolean);
      const low = parts.map(p=>p.toLowerCase());
      const has = low.includes(add.toLowerCase());

      if (chip.classList.contains('on') && !has){
        parts.push(add);
      }
      if (!chip.classList.contains('on') && has){
        const idx = low.indexOf(add.toLowerCase());
        if (idx >= 0) parts.splice(idx, 1);
      }
      tagsEl.value = parts.join(', ');
    });

    // -----------------------------
    // Guide modal
    // -----------------------------
    const guideBackdrop = document.getElementById('guideBackdrop');
    const btnOpenGuide = document.getElementById('btnOpenGuide');
    const btnCloseGuide = document.getElementById('btnCloseGuide');
    const btnCloseGuide2 = document.getElementById('btnCloseGuide2');

    function openGuide(){
      guideBackdrop.style.display = 'flex';
      guideBackdrop.setAttribute('aria-hidden', 'false');
      // prevent background scroll
      document.body.style.overflow = 'hidden';
    }
    function closeGuide(){
      guideBackdrop.style.display = 'none';
      guideBackdrop.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
    }

    btnOpenGuide.addEventListener('click', openGuide);
    btnCloseGuide.addEventListener('click', closeGuide);
    btnCloseGuide2.addEventListener('click', closeGuide);
    guideBackdrop.addEventListener('click', (e) => {
      if (e.target === guideBackdrop) closeGuide();
    });

    // close on ESC (desktop)
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && guideBackdrop.style.display === 'flex') closeGuide();
    });

    // -----------------------------
    // Build payload for bot
    // -----------------------------
    function buildPayload(){
  const title = document.getElementById('title').value.trim();
  const tags = tagsEl.value.trim();
  const make_instrumental = document.getElementById('instr').checked;
  const desc = document.getElementById('desc').value.trim();
  const lyrics = document.getElementById('lyrics').value.trim();

  const isUdio = (ai === "udio");
  const useMode = isUdio ? "idea" : mode; // Udio: —Ç–æ–ª—å–∫–æ –∏–¥–µ—è

  const payload = {
    feature: "music_future",
    ai: ai,                 // "suno" | "udio"
    mode: useMode,          // "idea" | "lyrics"
    title: isUdio ? "" : (title || ""),
    tags:  isUdio ? "" : (tags || ""),
    make_instrumental: !!make_instrumental
  };

  if (useMode === "idea") {
    // Udio/Suno idea prompt
    payload.gpt_description_prompt = (desc || "").trim();
  } else {
    // Suno lyrics mode
    payload.prompt = (lyrics || "").trim();
  }

  return payload;
}

    // -----------------------------
    // Save -> sendData -> close
    // -----------------------------
    document.getElementById('btnSave').addEventListener('click', () => {
      const payload = buildPayload();
      const dataStr = JSON.stringify(payload);

      // try get tg right before send (late init)
      const t = tg || initTelegram();

      if (t) {
        try {
          t.sendData(dataStr);
          okCopied.textContent = "–ì–æ—Ç–æ–≤–æ ‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç.";
          okCopied.style.display = "block";
          setTimeout(() => { try { t.close(); } catch(e){} }, 250);
          return;
        } catch(e) {
          // fallback below
        }
      }

      // Browser fallback: copy to clipboard
      if (navigator.clipboard && navigator.clipboard.writeText) {
        navigator.clipboard.writeText(dataStr).then(() => {
          okCopied.textContent = "–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä ‚úÖ (–æ—Ç–∫—Ä—ã—Ç–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ)";
          okCopied.style.display = "block";
        }).catch(() => {
          alert(dataStr);
        });
      } else {
        alert(dataStr);
      }
    });

    document.getElementById('btnClear').addEventListener('click', () => {
      document.getElementById('title').value = "";
      document.getElementById('tags').value = "";
      document.getElementById('instr').checked = false;
      document.getElementById('desc').value = "";
      document.getElementById('lyrics').value = "";
      document.querySelectorAll('.chip.on').forEach(c=>c.classList.remove('on'));
      setMode("idea");
      okCopied.style.display = "none";
      closeGuide();
    });
  </script>
</body>
</html>
